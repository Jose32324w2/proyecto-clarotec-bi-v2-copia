server {
    listen 80;
    server_name _; # Acepta cualquier dominio por ahora (o pon tu dominio No-IP aquí)

    # Logs
    access_log /var/log/nginx/clarotec_access.log;
    error_log /var/log/nginx/clarotec_error.log;

    # Frontend (React Build)
    location / {
        root /var/www/proyecto-clarotec/frontend/build;
        index index.html index.htm;
        try_files $uri $uri/ /index.html;
    }

    # Backend (Django API)
    location /api/ {
        # Reescribe /api/x a /x si tu Django NO espera /api en las urls
        # Si tus urls en django empiezan con api/, quita la linea rewrite
        # rewrite ^/api/(.*) /$1 break; 
        
        include proxy_params;
        proxy_pass http://unix:/var/www/proyecto-clarotec/backend/clarotec.sock;
    }
    
    # Django Admin y otras rutas de backend si es necesario
    location /admin/ {
        include proxy_params;
        proxy_pass http://unix:/var/www/proyecto-clarotec/backend/clarotec.sock;
    }

    # Archivos Estáticos de Django
    location /django_static/ {
        alias /var/www/proyecto-clarotec/backend/staticfiles/;
    }

    # Archivos de Medios (Uploads)
    location /media/ {
        alias /var/www/proyecto-clarotec/backend/media/;
    }
}
